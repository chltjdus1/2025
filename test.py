# ----------------------------
# 1. 필요한 라이브러리 불러오기
# ----------------------------
import streamlit as st   # 웹앱 제작용 라이브러리
import random            # 리스트에서 무작위 선택용

# ----------------------------
# 2. 확장된 한국어 감정 분석 함수 정의
# ----------------------------
def extended_sentiment_analysis(text):
    """
    사용자의 문장을 분석하여 감정을 반환하는 함수
    - 긍정: 행복, 즐거움, 설렘, 만족, 신남
    - 부정: 슬픔, 우울, 외로움, 짜증, 피곤, 긴장
    - 중립: 보통, 평온, 무난
    """
    text = text.lower()  # 소문자로 변환하여 키워드 비교

    # 긍정 키워드 목록
    positive_keywords = ["좋아", "행복", "즐거", "신나", "기쁨", "만족", "설렘", "행복해", "신난", "좋은"]
    # 부정 키워드 목록
    negative_keywords = ["슬퍼", "우울", "짜증", "화나", "싫어", "힘들", "피곤", "외로움", "긴장", "불안"]
    # 중립 키워드 목록
    neutral_keywords = ["보통", "무난", "평온", "그냥"]

    # 키워드 매칭하여 감정 반환
    if any(word in text for word in positive_keywords):
        return "긍정"
    elif any(word in text for word in negative_keywords):
        return "부정"
    else:
        return "중립"

# ----------------------------
# 3. 감정별 음식 추천 데이터 (10개 이상)
# ----------------------------
mood_foods = {
    "긍정": [
        "파스타", "초밥", "딸기 파르페", "샐러드", "치킨",
        "팬케이크", "아이스크림", "스무디", "와플", "마카롱"
    ],
    "중립": [
        "치즈 피자", "샌드위치", "타코", "볶음밥", "계란말이",
        "우동", "김밥", "샐러리 스틱", "치즈 토스트", "컵케이크"
    ],
    "부정": [
        "초콜릿 케이크", "라멘", "삼계탕", "죽", "떡볶이",
        "카레", "스프", "김치찌개", "라자냐", "비빔밥"
    ]
}

# ----------------------------
# 4. Streamlit 화면 구성
# ----------------------------
# 페이지 설정 (아이콘 없이)
st.set_page_config(page_title="음식 추천 웹앱", layout="centered")  
# - page_title: 브라우저 탭 제목  
# - layout="centered": 화면 중앙 배치  

# 앱 제목과 설명
st.title("🍽️ 기분 → 감정 분석 → 랜덤 음식 추천")
st.write("👉 기분에 맞는 음식을 랜덤으로 추천해 드립니다!")

# 사용자로부터 기분 입력 받기
user_input = st.text_input("지금 기분을 자유롭게 입력해주세요 (예: '오늘 너무 우울해요')")

# 사용자가 입력하면 실행
if user_input:
    # 1) 감정 분석
    mood = extended_sentiment_analysis(user_input)       
    # 2) 해당 감정 음식 중 랜덤 선택
    food = random.choice(mood_foods[mood])              

    # 분석 결과 출력
    st.success(f"**분석 결과:** {mood}")               # 감정 결과 표시

    # 추천 음식 출력 (이미지 없이 이름만)
    st.write(f"🎯 추천 음식: **{food}**")  
